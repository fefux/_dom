var _dom=function(){if(window._dom)return window._dom;var e="__dom",t={},n=function(e,t,n){var r;this.tagName=e,this.constructor=t,this.cssRules="function"==typeof n?n:"object"==typeof n?function(){return n}:0,this.getRules=function(e){return this.cssRules&&!r&&(r=o.rules(this.cssRules())),r}};n.prototype.build=function(t){var n=this.instance(t);return Object.defineProperty(n.dom,e,{get:function(){return n},configurable:!0}),n.dom},n.prototype.instance=function(e){return new n.Instance(this,e)},n.Instance=function(e,t){var n=e.constructor.apply(this,t);if(!(n instanceof HTMLElement))throw console.error("-----------------------"),console.log("tagName=",e.tagName),console.log("constructor=",e.constructor),console.log("this.dom=",n),"\n_dom.model Error:\nconstructor must return an HTMLElement.";if(n.__dom&&(this._super=n.__dom),Object.defineProperty(this,"tagName",{get:function(){return e.tagName}}),"dom"in this||Object.defineProperty(this,"dom",{get:function(){return n}}),e.cssRules){var o=e.getRules();Object.defineProperty(this,"rules",{get:function(){return o}})}};var o=function(e,n,o,r){var s=arguments;if(e in t)return t[e].build(s);try{var l="string"==typeof r?document.createElementNS(r,e):document.createElement(e);!o&&n instanceof Array&&(o=n,n={});var i=function(e,t,n){if(void 0===e)throw"property '"+n+"' doesn't exist.";for(var o in t)"object"==typeof t[o]?i(e[o],t[o],n+"."+o):e[o]=t[o]};if(i(l,n,(""+e).toUpperCase()),o&&"number"==typeof o.length)for(var c=0;c<o.length;c++)if("string"==typeof o[c])l.appendChild(document.createTextNode(o[c]));else try{l.appendChild(o[c])}catch(e){throw console.error("-----------------------"),console.log("childs["+c+"]=",o[c]),console.log("error=",e),"parameter childs["+c+"] must be string or dom element."}}catch(e){throw console.error("----------_dom Error"),console.log("arguments=",s),console.log("error=",e),"_dom Error:\n"+e}return l};o.model=function(e,r,s,l){if(-1===e.indexOf("-")&&console.warn('_dom.model suspect tagName "'+e+'" should contain at least one "-" to avoid conflict with natives HTMLElements.'),e in t)throw'\n_dom.model Error:\ntagName "'+e+'" allready exists.';if("function"!=typeof r)throw console.error("----------_dom.model Error"),console.log("tagName=",e),console.log("constructor=",r),"\n_dom.model Error:\nconstructor must be a function.";t[e]=new n(e,r,s),l&&o.modelShadow(e,l)},o.has=function(e){return e in t},o.instance=function(e,n){if(!(e in t))throw console.error("----------_dom.instance Error"),console.log("arguments=",arguments),'\n_dom.instance Error:\ntagName "'+e+'" not found in models.';return t[e].instance(arguments)},Object.defineProperty(o,"sheet",{get:function(){return 0==document.styleSheets.length&&document.documentElement.appendChild(o("style",[""])),document.styleSheets[document.styleSheets.length-1]}}),o.rule=function(e,t,n){if("string"!=typeof e||!e.length)throw console.error("----------_dom.rule Error"),console.log("selector=",e),"\n_dom.rule Error:\nselector is not a valid css query.";n instanceof CSSStyleSheet||(n=o.sheet),n.insertRule(e+"{\n\n}",n.cssRules.length);var r=n.cssRules[n.cssRules.length-1];if(t)for(var s in t)r.style[s]=t[s];return r},o.rules=function(e,t){let n={},r=o.getRulesData(e);t instanceof CSSStyleSheet||(t=o.sheet);for(let e in r.rules){try{n[e]=o.rule(e,r.rules[e],t)}catch(t){console.warn('_dom.rules Warning:\nInsertion of rule "'+e+'" failed!\n\n'+t)}e in r.alias&&(n[r.alias[e]]=n[e])}return n},o.getRulesData=function(e){let t={rules:{},alias:{}},n=function(e,o,r){let s,l={};r.length&&(s=r.join(""));for(let i in e){let c=i.charAt(0);if("$"===c)o[i.substr(1)]=e[i];else if("@"===c);else if(r.length&&"&"!==c)if("alias"===i)t.alias[s]=e[i];else{let t=e[i]+"";Object.keys(o).forEach(e=>{t=t.indexOf(e)>-1?t.split(e).join(o[e]):t}),l[i]=t}else(r.length?i.substr(1):i).split(",").forEach(t=>{n(e[i],Object.assign({},o),r.concat([t]))})}s&&(t.rules[s]=l)};return n(e,{},[]),t},o.hasClass=function(e,t){e.classList.contains(t)},o.addClass=function(e,t){e.classList.add(t)},o.removeClass=function(e,t){e.classList.remove(t)},o.swapClass=function(e,t,n){o.removeClass(e,n),o.addClass(e,t)};return o.modelShadowed=function(e){return!!t[e].shadow},o.modelShadow=function(e,n){if(!t[e])throw["","_dom.modelShadow Error:",'argument[0] "tagName"="'+e+'" has no model declared.'].join("\n");{if(o.modelShadowed(e))return;n="object"==typeof n?n:{};let r=e.split("-").map(e=>e.charAt(0).toUpperCase()+e.substr(1)).join(""),s=(t[e].constructor+"").split(")",2)[0].split("(")[1].split(","),l=s.map(e=>n.hasOwnProperty(e)?n[e]:0);class i extends HTMLElement{constructor(){super(),function(e,t,n,r){let s,l=e.attachShadow({mode:"open"});r=r||[];let i=n.slice(1).map((t,n)=>{let o,s=n+1;if(e.hasAttribute(t))if(o=e.getAttribute(t),"function"==typeof r[s])o=r[s](o);else if("boolean"===r[s])o=!(["false","0","off"].indexOf(o)>-1||!o.length);else if("int"===r[s])o=parseInt(o);else if("number"===r[s])o=parseFloat(o);else if("function"===r[s])o=new Function(""+o).bind(e);else if("string"!==r[s])try{o=JSON.parse(o)}catch(e){}return o});n=[t].concat(i),s=o.apply(null,n),l.appendChild(s);let c=[],a=s.__dom.rules;for(let e in a)c.push(a[e].cssText);l.appendChild(o("style",{type:"text/css",textContent:c.join("\n")}))}(this,e,s,l)}}t[e].shadow={name:r,[r]:class extends i{}},customElements.define(e,t[e].shadow[r])}},o}();